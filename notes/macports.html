<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="color-scheme" content="dark light">
    <title>MacPorts Notes</title>
    <style>body { font-family: sans-serif; }</style>
</head>

<body>

<h1>MacPorts Notes</h1>

<p>The these are some general notes about
<a href="https://www.macports.org/">MacPorts</a>.</p>
<ul>
    <li><a href="macports.html#common">Commonly Used Ports</a></li>
    <li><a href="macports.html#provides">Checking which Port provides a file</a></li>
    <li><a href="macports.html#ccache">Enabling ccache</a></li>
    <li><a href="macports.html#contrib">Contributing to MacPorts</a></li>
    <li><a href="macports.html#cdrtools">Making ISO images</a></li>
</ul>

<hr>

<h2><a id="common">Commonly Used Ports (x86 / M1)</a></h2>

<blockquote>

    <ol>

        <li>autoconf (for autoreconf):
        <a href="https://www.gnu.org/software/autoconf/"
        >https://www.gnu.org/software/autoconf/</a></li>

        <li>automake (to support autoreconf):
        <a href="https://www.gnu.org/software/automake/"
        >https://www.gnu.org/software/automake/</a></li>

        <li>cargo2port (macports helper for Rust-based ports):
        <a href="https://github.com/l2dy/cargo2port"
        >https://github.com/l2dy/cargo2port</a></li>

        <li>ccache (compile cache): <a href=
        "https://ccache.dev/">https://ccache.dev/</a></li>

        <li>cdrtools (make ISOs from CDs): <a href=
        "http://cdrtools.sourceforge.net/private/cdrecord.html"
        >http://cdrtools.sourceforge.net/private/cdrecord.html</a></li>

        <li>dnscrypt-proxy (encrypted dns):
        <a href="https://github.com/DNSCrypt/dnscrypt-proxy"
        >https://github.com/DNSCrypt/dnscrypt-proxy</a></li>

        <li>dosbox-x (enhanced dosbox):
        <a href="https://dosbox-x.com/"
        >https://dosbox-x.com/</a></li>

        <li>epy (cli ebook reader):
        <a href="https://github.com/wustho/epy"
        >https://github.com/wustho/epy</a></li>

        <li>gh (git hub CLI):
        <a href="https://docs.github.com/en/github-cli/github-cli/about-github-cli"
        >https://docs.github.com/en/github-cli/github-cli/about-github-cli</a>
        </li>

        <li>gnupg2 (GNU pretty good privacy):
        <a href="https://www.gnupg.org/"
        >https://www.gnupg.org/</a></li>

        <li>innoextract (extract files from Windows installers):
        <a href="https://constexpr.org/innoextract/"
        >https://constexpr.org/innoextract/</a></li>

        <li>libpst (extract files from Outlook PST archives):
        <a href="https://www.five-ten-sg.com/libpst/"
        >https://www.five-ten-sg.com/libpst/</a></li>

        <li>ncftp (terminal based ftp client):
        <a href="http://www.ncftpd.com/ncftp/"
        >http://www.ncftpd.com/ncftp/</a></li>

        <li>newsboat (terminal based RSS reader):
        <a href="https://newsboat.org/"
        >https://newsboat.org/</a></li>

        <li>oksh (portable version of OpenBSD's ksh):
        <a href="https://github.com/ibara/oksh"
        >https://github.com/ibara/oksh</a></li>

        <li>py-pipdeptree (python dependencies):
        <a href="https://pypi.org/project/pipdeptree/"
        >https://pypi.org/project/pipdeptree/</a></li>

        <li>qemu (multi-architecture emulator):
        <a href="https://www.qemu.org/"
        >https://www.qemu.org/</a></li>

        <li>rclone (sync files to cloud services):
        <a href="https://rclone.org/"
        >https://rclone.org/</a></li>

        <li>shellcheck (check the syntax of shell scripts):
        <a href="https://www.shellcheck.net/"
        >https://www.shellcheck.net/</a></li>

        <li>slrn (Usenet news reader):
        <a href="https://slrn.info/"
        >https://slrn.info/</a></li>

        <li>smartmontools (get SMART status for drives):
        <a href="https://www.smartmontools.org/"
        >https://www.smartmontools.org/</a></li>

        <li>tig (terminal based git history browser):
        <a href="https://jonas.github.io/tig/"
        >https://jonas.github.io/tig/</a></li>

        <li>tuir (terminal based reddit browser):
        <a href="https://gitlab.com/ajak/tuir"
        >https://gitlab.com/ajak/tuir</a></li>

        <li>unshield (extract Installshield archives):
        <a href="https://github.com/twogood/unshield"
        >https://github.com/twogood/unshield</a></li>

        <li>xorriso (cd tools):
        <a href="https://www.gnu.org/software/xorriso/"
        >https://www.gnu.org/software/xorriso/</a></li>

    </ol>

</blockquote>

<hr>
<h2><a id="provides">Checking which Port provides a file</a></h2>

<blockquote>
<pre>$ port provides [file]</pre>
</blockquote>

<hr>
<h2><a id="ccache">Enabling ccache</a></h2>

<blockquote>
<ol>
    <li><p>Install ccache:
        <pre>$ sudo port install ccache</pre>
        </p>
    </li>
    <li><p>In the file <code>/opt/local/etc/macports/macports.conf</code>,
        uncomment the line:
        <pre>configureccache     no</pre>
        and change it to read:
        <pre>configureccache     yes</pre></p>
    </li>
</ol>

From: <a href="https://trac.macports.org/wiki/howto/ccache"
      >https://trac.macports.org/wiki/howto/ccache</a>.
</blockquote>

<hr>
<h2><a id="contrib">Contributing to MacPorts</a></h2>

<blockquote>

    <ol>
        <li><p>Create a fork on GitHub</p></li>
        <li>Clone the fork locally:
            <pre>$ git clone https://github.com/<i>username</i>/macports-ports.git</pre>
            where <i>username</i> your github username.<br><br>
        </li>
        <li>Add the official repository as the upstream:
            <pre>$ git remote add upstream https://github.com/macports/macports-ports.git</pre>
        </li>
        <li><p>On GitHub, update the fork to include any upstream changes,
            for example:</p>
            <pre>$ gh repo sync <i>username</i>/macports-ports</pre>
            where <i>username</i> your github username.<br><br>
            See: <a href="https://docs.github.com/en">GitHub Docs</a>,
            <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/working-with-forks/syncing-a-fork"
            >Syncing a fork</a><br><br>
        </li>
        <li>Fetch upstream changes locally:
            <pre>$ git fetch upstream &amp;&amp; git pull</pre>
        </li>
        <li>Create a branch for changes:
            <pre>$ git checkout -b <i>portname</i>-<i>version</i></pre>
            where <i>portname</i> is the name of the port and <i>version</i>
            is the version of the port<br><br>
        </li>
        <li>After making changes, lint the Portfile:
            <pre>$ port lint --nitpick -D .</pre>
        </li>
        <li>Commit the changes:
            <pre>$ git commit -a -m "<i>portname</i>: update to <i>version</i>" [-S]</pre>
            where <i>portname</i> is the name of the port, <i>version</i>
            is the version of the port, and -S is optional (assuming that signing
            commits is enabled)<br><br>
        </li>
        <li>Push the changes upstream:
            <pre>$ git push --set-upstream origin <i>portname</i>-<i>version</i></pre>
            where <i>portname</i> is the name of the port and <i>version</i>
            is the version of the port<br>
        </li>
        <li><p>Open a pull request on GitHub</p></li>
        <li>If changes are requested, make the changes, lint the Portfile (see
            above), and then override the prior commit:
            <pre>$ git commit --amend -a -m "<i>portname</i>: update to <i>version</i>" [-S]
$ git push origin -f</pre>
            where <i>portname</i> is the name of the port, <i>version</i>
            is the version of the port, and -S is optional (assuming that signing
            commits is enabled).<br><br>
            If the changes require the branch to be  rebased to the
            master, then do the following before amending the prior commit:
            <pre>$ git pull --rebase origin master</pre>
            See: <a href="https://stackoverflow.com/questions/7929369/"
            >https://stackoverflow.com/questions/7929369/</a>.<br><br>
        </li>
        <li>Switch back to the main/master branch:
            <pre>$ git checkout master</pre>
        </li>
        <li>Once the pull request is merged, delete the local and remote branches:
            <br><br>
            <ul>
            <li>Delete the local branch:
                <pre>$ git branch -D <i>portname</i>-<i>version</i></pre>
                where <i>portname</i> is the name of the port and <i>version</i>
                is the version of the port<br><br>
            </li>
            <li>Delete the remote branch:
                <pre>$ git push origin --delete <i>portname</i>-<i>version</i></pre>
                where <i>portname</i> is the name of the port and <i>version</i>
                is the version of the port<br><br>
            </li>
            <li>Synchronize local and remote branches:
                <pre>$ git fetch -p</pre>
            </li>
            </ul>
        </li>
    </ol>

</blockquote>

<hr>
<h2><a id="cdrtools">Making ISO images</a></h2>

<blockquote>

    <ol>
        <li>Install cdrools:
        <pre>$sudo port install cdrtools</pre>
        </li>
        <li>Make a mount point for the cd, if it doesn't exist:
        <pre>$ sudo mkdir /Volumes/cdrom</pre>
        </li>
        <li><p>Find the non-Mac/HFS partition/slice on the cd using
        <code>diskutil list</code> (often it is slice 1)</p>
        </li>
        <li>Mount the non-Mac/HFS partition on the cdrom:
        <pre>$ sudo mount_cd9660 -r /dev/disk[<i>X</i>]s[<i>Y</i>] /Volumes/cdrom</pre>
        where <i>X</i> is the disk number for the cd shown by
        <code>diskutil list</code> and <i>Y</i> is the slice number for the cd
        shown by <code>diskutil list</code>.<br><br>
        </li>
        <li>Create the ISO image using <code>mkisofs</code> from cdrtools:
        <pre>$ mkisofs -v -J -r -V [<i>VOLNAME</i>] -o [<i>ISO PATH</i>] /Volumes/cdrom</pre>
        where <i>VOLNAME</i> is the volume name for the ISO and
        <i>ISO PATH</i> is the location where the ISO should be saved.<br><br>
        </li>
        <li>Unmount the cd:
        <pre>$ umount /Volumes/cdrom</pre>
        </li>
        <li>Eject the cd:
        <pre>$ diskutil eject /dev/disk[<i>X</i>]</pre>
        where <i>X</i> is the disk number shown by <code>diskutil list</code>.<br>
        </li>
    </ol>

    Based on: <a href=
    "https://lists.macports.org/pipermail/macports-users/2022-April/051105.html"
    >https://lists.macports.org/pipermail/macports-users/2022-April/051105.html</a>
</blockquote>

<hr>

<p>
<a href="../index.html">Home</a>&nbsp;/&nbsp;<a href="index.html">Notes</a>
</p>

</body>
</html>

